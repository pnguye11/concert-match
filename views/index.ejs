<!DOCTYPE html>
<html>
  <head>
    <title>Concert Match</title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script src="https://code.jquery.com/jquery-3.0.0.js" integrity="sha256-jrPLZ+8vDxt2FnE1zvZXCkCcebI/C8Dt5xyaQBjxQIo=" crossorigin="anonymous"></script>
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.20.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.20.1/mapbox-gl.css' rel='stylesheet' />
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>
  </head>
  <body>
    <% include ./partials/_nav %>
    <% include ./partials/_map %>
    <div class="container">
<div id="map"></div>
      <% if (user) { %>
         <% artists.forEach(function(el, i, arr){ %>

      <div class="row">
        <div class="col s6 l6 offset-l6">
          <div class="card">
            <div class="card-image">
              <img src="<%=   el.image; %>">
              <span class="card-title"><%=i+1 + ". "%><%=   el.name; %></span>
            </div>
            <div class="card-content">
              <p>I am a very simple card. I am good at containing small bits of information.
              I am convenient because I require little markup to use effectively.</p>
            </div>
            <div class="card-action">
              <a href="#">This is a link</a>
            </div>
          </div>
        </div>
      </div>
<% }); %>



        <%= artists %>

        <a href="/logout">Logout</a>
      <% } else { %>
        <a href="/auth/spotify">Login</a>
      <% } %>

  <script>
    var lat, lng;
    navigator.geolocation.getCurrentPosition(function(pos){
      lat = pos.coords.latitude;
      lng = pos.coords.longitude;
      $.post('/api/location', {
        lat: lat,
        lng: lng
      }).then(function(data) {
        // center map based on lat, lng
        console.log(data);
      });
    });
  </script>

  </body>
</html>
